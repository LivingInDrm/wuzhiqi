<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ¨çº¿å¯¹æˆ˜è°ƒè¯•æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .player { border: 1px solid #ccc; padding: 20px; margin: 10px; }
        .status { margin: 10px 0; }
        button { padding: 10px; margin: 5px; }
    </style>
</head>
<body>
    <h1>åœ¨çº¿å¯¹æˆ˜è°ƒè¯•æµ‹è¯•</h1>
    
    <div class="player" id="player1">
        <h3>ç©å®¶1 (lxc)</h3>
        <div class="status" id="status1">ç­‰å¾…è¿æ¥...</div>
        <button onclick="connectPlayer1()">è¿æ¥</button>
        <button onclick="joinQueue1()">åŠ å…¥é˜Ÿåˆ—</button>
    </div>
    
    <div class="player" id="player2">
        <h3>ç©å®¶2 (lxc1)</h3>
        <div class="status" id="status2">ç­‰å¾…è¿æ¥...</div>
        <button onclick="connectPlayer2()">è¿æ¥</button>
        <button onclick="joinQueue2()">åŠ å…¥é˜Ÿåˆ—</button>
    </div>

    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script>
        let socket1 = null;
        let socket2 = null;
        
        // ç©å®¶1 token (lxc)
        const token1 = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjMsInVzZXJuYW1lIjoibHhjIiwiaWF0IjoxNzQ5NjU2Njk3LCJleHAiOjE3NDk3NDMwOTd9.Tp_5QMBTKpTLb5EGuvgqZuKM0U8fE6L-pMJKiMNuOrg';
        
        // ç©å®¶2 token (lxc1)  
        const token2 = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjQsInVzZXJuYW1lIjoibHhjMSIsImlhdCI6MTc0OTY1NjcwMiwiZXhwIjoxNzQ5NzQzMTAyfQ.CZlKLDQyK5e0G1rg0v-b_Cy66pE4TlHCGrxKwg-EZG4';
        
        function updateStatus(playerId, message) {
            document.getElementById(`status${playerId}`).innerHTML = message;
            console.log(`Player${playerId}: ${message}`);
        }
        
        function connectPlayer1() {
            if (socket1) {
                socket1.disconnect();
            }
            
            updateStatus(1, 'è¿æ¥ä¸­...');
            socket1 = io('http://localhost:3000', {
                auth: { token: token1 }
            });
            
            socket1.on('connect', () => {
                updateStatus(1, 'å·²è¿æ¥ (lxc)');
            });
            
            socket1.on('connect_error', (error) => {
                updateStatus(1, `è¿æ¥å¤±è´¥: ${error.message}`);
            });
            
            socket1.on('queueJoined', (data) => {
                updateStatus(1, `åŠ å…¥é˜Ÿåˆ—: ä½ç½®${data.queuePosition || 'æœªçŸ¥'}`);
            });
            
            socket1.on('gameStart', (data) => {
                console.log('ğŸ® [Player1] gameStartäº‹ä»¶:', data);
                updateStatus(1, `æ¸¸æˆå¼€å§‹! å¯¹æ‰‹: ${data.opponent.username}, æ‚¨æ‰§: ${data.yourPiece}, è½®åˆ°æ‚¨: ${data.isYourTurn}`);
            });
        }
        
        function connectPlayer2() {
            if (socket2) {
                socket2.disconnect();
            }
            
            updateStatus(2, 'è¿æ¥ä¸­...');
            socket2 = io('http://localhost:3000', {
                auth: { token: token2 }
            });
            
            socket2.on('connect', () => {
                updateStatus(2, 'å·²è¿æ¥ (lxc1)');
            });
            
            socket2.on('connect_error', (error) => {
                updateStatus(2, `è¿æ¥å¤±è´¥: ${error.message}`);
            });
            
            socket2.on('queueJoined', (data) => {
                updateStatus(2, `åŠ å…¥é˜Ÿåˆ—: ä½ç½®${data.queuePosition || 'æœªçŸ¥'}`);
            });
            
            socket2.on('gameStart', (data) => {
                console.log('ğŸ® [Player2] gameStartäº‹ä»¶:', data);
                updateStatus(2, `æ¸¸æˆå¼€å§‹! å¯¹æ‰‹: ${data.opponent.username}, æ‚¨æ‰§: ${data.yourPiece}, è½®åˆ°æ‚¨: ${data.isYourTurn}`);
            });
        }
        
        function joinQueue1() {
            if (socket1 && socket1.connected) {
                socket1.emit('joinQueue');
                updateStatus(1, 'æ­£åœ¨åŠ å…¥é˜Ÿåˆ—...');
            } else {
                updateStatus(1, 'è¯·å…ˆè¿æ¥');
            }
        }
        
        function joinQueue2() {
            if (socket2 && socket2.connected) {
                socket2.emit('joinQueue');
                updateStatus(2, 'æ­£åœ¨åŠ å…¥é˜Ÿåˆ—...');
            } else {
                updateStatus(2, 'è¯·å…ˆè¿æ¥');
            }
        }
    </script>
</body>
</html>